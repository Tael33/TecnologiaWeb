<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Carrinho de Compras</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    

<div class="container">
    <h2>Adicionar Produtos</h2>
    
    <label>Código:</label>
    <input type="number" id="inputCodigo">
    
    <label>Nome:</label>
    <input type="text" id="inputNome">
    
    <label>Preço:</label>
    <input type="number" id="inputPreco">
    
    <br>
    <button onclick="adicionarProduto()">Adicionar ao carrinho</button>

    <h2>Carrinho:</h2>
    <ul id="listaCarrinho">
        </ul>

    <p class="total" id="textoTotal">Total: R$ 0.00</p>

    <hr>

    <h2>Remover Produto</h2>
    <label>Código para remover:</label>
    <input type="number" id="inputRemoverCodigo">
    <button onclick="removerProduto()">Remover</button>
</div>

<script>
    // DICA DA IMAGEM 3: Guarde os produtos em um array de produtos.
    // Estrutura interna será: [ [codigo, nome, preco], [codigo, nome, preco] ]
    let carrinho = [];

    function adicionarProduto() {
        // Pegar os valores dos inputs
        let codigo = document.getElementById("inputCodigo").value;
        let nome = document.getElementById("inputNome").value;
        let preco = parseFloat(document.getElementById("inputPreco").value);

        // Validação simples para não adicionar vazio
        if (codigo === "" || nome === "" || isNaN(preco)) {
            alert("Por favor, preencha todos os campos!");
            return;
        }

        // REGRA: Verificar se já existe (Proibido usar find/filter/includes)
        let existe = false;
        
        // Usamos um FOR simples para percorrer o array
        for (let i = 0; i < carrinho.length; i++) {
            // carrinho[i][0] é o código do produto na posição i
            if (carrinho[i][0] == codigo) {
                existe = true;
                break; // Para o loop se encontrar
            }
        }

        if (existe) {
            // Comportamento Esperado 1: Alert se repetido
            alert("Já existe um produto com esse código!");
        } else {
            // Adiciona no array (Push é permitido pois é básico de vetores)
            // Guardamos como um vetor: [codigo, nome, preco]
            carrinho.push([codigo, nome, preco]);

            // Manipulação do DOM (Dica da Imagem 3: createElement e appendChild)
            let lista = document.getElementById("listaCarrinho");
            let itemLista = document.createElement("li");
            
            // Formatação: 101 - Teclado - R$ 150.00
            itemLista.innerText = codigo + " - " + nome + " - R$ " + preco.toFixed(2);
            
            // DICA DA IMAGEM 3: Colocar ID no elemento para facilitar remoção
            itemLista.id = "produto-" + codigo;

            lista.appendChild(itemLista);

            // Atualizar o total
            atualizarTotal();
            
            // Limpar inputs (opcional, mas boa prática)
            document.getElementById("inputCodigo").value = "";
            document.getElementById("inputNome").value = "";
            document.getElementById("inputPreco").value = "";
        }
    }

    function removerProduto() {
        let codigoRemover = document.getElementById("inputRemoverCodigo").value;
        let encontrou = false;
        let indiceParaRemover = -1;

        // REGRA: Achar o item para remover (Sem usar findIndex ou filter)
        for (let i = 0; i < carrinho.length; i++) {
            if (carrinho[i][0] == codigoRemover) {
                indiceParaRemover = i;
                encontrou = true;
                break;
            }
        }

        if (encontrou) {
            // 1. Remover do Array (Splice remove itens de um array pelo índice)
            carrinho.splice(indiceParaRemover, 1);

            // 2. Remover do HTML (Dica da Imagem 3: getElementById + remove)
            let itemDom = document.getElementById("produto-" + codigoRemover);
            if (itemDom) {
                itemDom.remove();
            }

            // 3. Atualizar Total
            atualizarTotal();

        } else {
            // Comportamento Esperado 3: Alert se não encontrado
            alert("Produto não encontrado!");
        }
    }

    function atualizarTotal() {
        let total = 0;

        // REGRA: Somar todos os valores (Sem reduce)
        for (let i = 0; i < carrinho.length; i++) {
            // carrinho[i][2] é o preço
            total = total + carrinho[i][2];
        }

        // Exibir no <p>
        let elementoTotal = document.getElementById("textoTotal");
        elementoTotal.innerText = "Total: R$ " + total.toFixed(2);
    }
</script>

</body>
</html>